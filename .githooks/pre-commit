#!/bin/bash
# Git pre-commit hook for Salita
# Install: git config core.hooksPath .githooks

set -e

echo "ğŸ” Running pre-commit checks..."

# Run cargo fmt
if ! cargo fmt -- --check; then
    echo "âŒ Code not formatted. Running cargo fmt..."
    cargo fmt
    echo "âœ… Code formatted. Please stage the changes and commit again."
    exit 1
fi

# Run cargo clippy (warnings only, don't block)
echo "ğŸ” Running clippy..."
cargo clippy -- -W clippy::all 2>&1 | head -30 || true

# Run unit tests
echo "ğŸ§ª Running tests..."
if ! cargo test --lib; then
    echo "âŒ Tests failed"
    exit 1
fi

echo "âœ… Pre-commit checks passed!"
